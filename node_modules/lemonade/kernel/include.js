/******************************************************************************
 * Lemonade JS
 * https://lemonadejs.com
 *
 * ----
 *
 * Include
 *
 *  Load the appropriate includer based on path's content-type (extension for
 *  now). Every includer also has a clearcache method clearing require cache
 *  or other caches
 *
 *****************************************************************************/

var js   = require('./include/js.js')
,   swig = require('./include/swig.js');

/**
 * Load the includer
 * @param {string} path
 * @param {object} context
 * @param {object} kernel
 * @returns {*}
 */
function include(path, context, kernel) {
    var extension = path.substring(
        path.lastIndexOf('.') + 1, path.length
    );
    try {
        switch (extension) {
            case 'swig' :
            case 'swg'  :
                    return swig.include(path, context, kernel);
                break;
            default :
                    return js.include(path, context, kernel);
                break;
        }
    } catch (e) {
        this.kernel.error(
            new Error(
                'Failed to load content-type not supported : ' + extension + ' : ' + e.message
            )
        );
    }
}

/**
 * Clear includer caches
 * @param {object} kernel
 */
function clearcache(kernel) {
    js  .clearcache(kernel);
    swig.clearcache(kernel);
}

/**
 * Exports
 */
exports = module.exports = {
    include : include, clearcache : clearcache
};